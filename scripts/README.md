# Scripts Directory

This directory contains scripts and sample files for setting up and using PG-View.

## üìÅ Files Overview

### Python Scripts

#### `generate_dummy_data.py`
**Purpose**: Generate sample graph data with 500 nodes and 3000+ edges

**Usage**:
```bash
python3 scripts/generate_dummy_data.py
```

**Output**: Creates `dummy_graph_data.json` with:
- 300 Person nodes (name, age, city, email)
- 100 Company nodes (name, industry, size, founded)
- 100 Product nodes (name, price, category, rating)
- 3180+ edges with properties (works_at, knows, bought, produces)

**Requirements**: Python 3.7+, no external dependencies

---

#### `load_dummy_data.py`
**Purpose**: Load generated dummy data into PG-View database via REST API

**Usage**:
```bash
# Prerequisites: API server must be running
python3 scripts/load_dummy_data.py
```

**What it does**:
1. Connects to PostgreSQL
2. Creates 'DummyGraph' database
3. Adds schema (node/edge types)
4. Inserts all nodes with properties
5. Inserts all edges with properties
6. Creates a sample view

**Requirements**: 
- Python 3.7+
- `requests` library (`pip install requests`)
- API server running on localhost:7070
- `dummy_graph_data.json` (generated by `generate_dummy_data.py`)

---

### Shell Scripts

#### `quick_start.sh`
**Purpose**: Automated setup for entire PG-View system

**Usage**:
```bash
./scripts/quick_start.sh
```

**What it does**:
1. Checks prerequisites (Java, Maven, Python, PostgreSQL)
2. Compiles the project
3. Starts API server (port 7070)
4. Starts Web UI server (port 8080)
5. Optionally generates and loads sample data
6. Provides access URLs and next steps

**Requirements**: All PG-View prerequisites installed

---

### GQL Scripts

#### `create_sample_graph.gql`
**Purpose**: Create a small knowledge graph with realistic data

**Usage**:
```bash
# Via console
mvn exec:java@console -Dexec.args="scripts/create_sample_graph.gql"

# Or copy-paste into Web UI Execute tab
```

**Creates**:
- 5 Person nodes with properties
- 2 Company nodes with properties
- 3 Product nodes with properties
- 2 City nodes with properties
- Multiple relationship edges (works_at, knows, bought, lives_in, located_in)
- Sample views (ColleaguesView)

**Good for**: Testing, learning the query syntax

---

#### `sample_queries.gql`
**Purpose**: Collection of example queries demonstrating various patterns

**Usage**: Copy individual queries into Web UI Query tab or console

**Includes**:
- Basic queries (find all nodes/edges)
- Relationship queries (who works where, social network)
- Multi-hop queries (colleagues, friends of friends)
- Path queries (complex patterns)
- View creation examples
- View querying examples

**Good for**: Learning query syntax, testing functionality

---

### Data Files

#### `dummy_graph_data.json`
**Purpose**: Generated graph data in JSON format

**Structure**:
```json
{
  "nodes": [
    {
      "id": 1,
      "label": "Person",
      "properties": {"name": "...", "age": 30, ...}
    }
  ],
  "edges": [
    {
      "id": 1000,
      "from": 1,
      "to": 2,
      "label": "knows",
      "properties": {"since": 2020, ...}
    }
  ],
  "summary": {...}
}
```

**Generated by**: `generate_dummy_data.py`  
**Used by**: `load_dummy_data.py`

---

## üöÄ Quick Start Workflows

### Workflow 1: Automated Setup (Recommended)
```bash
# One command to rule them all
./scripts/quick_start.sh
```

### Workflow 2: Manual Step-by-Step
```bash
# 1. Compile project
mvn clean compile

# 2. Start API server (terminal 1)
mvn exec:java@api

# 3. Start Web UI (terminal 2)
cd web-ui && python3 -m http.server 8080

# 4. Generate and load data (terminal 3)
python3 scripts/generate_dummy_data.py
python3 scripts/load_dummy_data.py

# 5. Open browser
open http://localhost:8080
```

### Workflow 3: Small Test Data
```bash
# Start servers (as above), then:
mvn exec:java@console -Dexec.args="scripts/create_sample_graph.gql"
```

### Workflow 4: Python-Only
```python
# In Python
import sys
sys.path.append('python-client')
from pgview_client import PGViewClient

# Generate data
import subprocess
subprocess.run(['python3', 'scripts/generate_dummy_data.py'])

# Load via Python client
client = PGViewClient()
# ... (see load_dummy_data.py for details)
```

---

## üìä Data Statistics

### Dummy Data (generate_dummy_data.py + load_dummy_data.py)
- **Nodes**: 500 total
  - Person: 300 (4 properties each)
  - Company: 100 (4 properties each)
  - Product: 100 (4 properties each)
- **Edges**: 3,180 total
  - works_at: ~213 (4 properties each)
  - knows: ~1,763 (3 properties each)
  - bought: ~893 (3 properties each)
  - produces: ~311 (2 properties each)
- **Total Properties**: ~11,442
- **Database Size**: ~15-20 MB in PostgreSQL

### Sample Data (create_sample_graph.gql)
- **Nodes**: 12 total (5 Person, 2 Company, 3 Product, 2 City)
- **Edges**: 18 total
- **Database Size**: <1 MB
- **Good for**: Quick testing, learning

---

## üîß Customization

### Modify Dummy Data Generation
Edit `generate_dummy_data.py`:
```python
# Change these at the top of the file
NUM_PERSONS = 300      # Increase for more nodes
NUM_COMPANIES = 100
NUM_PRODUCTS = 100
```

### Create Custom GQL Scripts
Template:
```gql
connect pg;
create graph MyGraph;
use MyGraph;

add node MyNodeType;
add edge MyEdgeType MyNodeType MyNodeType;

insert N(1, "MyNodeType");
insert E(100, 1, 2, "MyEdgeType");

MATCH (n:MyNodeType) FROM g RETURN (n);
```

---

## üêõ Troubleshooting

### "API server not running" error
```bash
# Check if API is running
curl http://localhost:7070/health

# Start if not running
mvn exec:java@api
```

### "File not found: dummy_graph_data.json"
```bash
# Generate it first
python3 scripts/generate_dummy_data.py
```

### "Connection to PostgreSQL failed"
```bash
# Check PostgreSQL is running
sudo service postgresql status

# Check credentials in conf/graphview.conf
cat conf/graphview.conf | grep postgres
```

### Scripts not executable
```bash
chmod +x scripts/*.py scripts/*.sh
```

---

## üìö Related Documentation

- **Main README**: `../README_VISUALIZATION.md`
- **API Documentation**: `../API_QUICK_START.md`
- **Python Client**: `../python-client/README.md`
- **Implementation Details**: `../Implementation_detail.md`

---

## üí° Tips

1. **Performance**: For large datasets (1000+ nodes), increase the visualization limit carefully
2. **Development**: Use `create_sample_graph.gql` for quick testing
3. **Production**: Modify `generate_dummy_data.py` to match your domain
4. **Debugging**: Check `/tmp/pgview_api.log` for API errors
5. **Cleanup**: Drop graphs with `drop graph GraphName;` command

---

## üéØ What to Run

**Just starting?**
```bash
./scripts/quick_start.sh
```

**Want small test data?**
```bash
mvn exec:java@console -Dexec.args="scripts/create_sample_graph.gql"
```

**Want large realistic data?**
```bash
python3 scripts/generate_dummy_data.py
python3 scripts/load_dummy_data.py
```

**Want to experiment with queries?**
- Open `scripts/sample_queries.gql`
- Copy queries to Web UI Query tab

